const apiKey = '0506342233b71596c08cbfca3e3cf71c'; // Replace with your OpenWeatherMap API key
let currentCity = 'Abuja'; // default city

async function fetchWeather(cityName = currentCity) {
  try {
    // Current Weather
    const response = await fetch(https://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=${apiKey}&units=metric);
    const data = await response.json();

    currentCity = data.name;

    document.getElementById('city-name').textContent = ${data.name}, ${data.sys.country};
    document.getElementById('current-temp').innerHTML = `
      <img src="https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png" 
           alt="${data.weather[0].description}" width="50">
      ${Math.round(data.main.temp)}°C | ${data.weather[0].main}
    `;
    document.getElementById('details').textContent = Humidity: ${data.main.humidity}% | Wind: ${data.wind.speed} km/h;

    // 5-Day Forecast
    const forecastResponse = await fetch(https://api.openweathermap.org/data/2.5/forecast?q=${cityName}&appid=${apiKey}&units=metric);
    const forecastData = await forecastResponse.json();

    const forecastGrid = document.getElementById('forecast-grid');
    forecastGrid.innerHTML = '';

    for (let i = 0; i < forecastData.list.length; i += 8) {
      const day = forecastData.list[i];
      const date = new Date(day.dt * 1000);
      const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });

      const temp = Math.round(day.main.temp);
      const icon = https://openweathermap.org/img/wn/${day.weather[0].icon}@2x.png;

      const card = `
        <div class="forecast-card">
          <h4>${dayName}</h4>
          <p><img src="${icon}" alt="${day.weather[0].description}"></p>
          <p>${temp}°C</p>
        </div>
      `;
      forecastGrid.innerHTML += card;
    }

  } catch (error) {
    alert('City not found. Please try again.');
    console.error('Error fetching weather:', error);
  }
}

// Event listener for search button
document.getElementById('search-btn').addEventListener('click', () => {
  const cityInput = document.getElementById('city-input').value.trim();
  if(cityInput) fetchWeather(cityInput);
});

// Optional: search on Enter key
document.getElementById('city-input').addEventListener('keyup', (e) => {
  if(e.key === 'Enter') {
    const cityInput = e.target.value.trim();
    if(cityInput) fetchWeather(cityInput);
  }
});

// Initial fetch
fetchWeather();

// Auto-refresh current city every 5 minutes
setInterval(() => fetchWeather(currentCity), 300000);